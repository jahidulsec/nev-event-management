generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model approver {
  id            String             @id @default(nanoid()) @db.VarChar(21)
  event_type_id String             @db.VarChar(21)
  user_type     user_role
  type          approver_type
  created_at    DateTime?          @default(now()) @db.Timestamp(0)
  updated_at    DateTime?          @default(now()) @db.Timestamp(0)
  event_type    event_type         @relation(fields: [event_type_id], references: [id], onUpdate: Restrict, map: "approver_ibfk_1")

  @@index([event_type_id], map: "event_type_id")
}

model doctor {
  id               String             @id @default(nanoid()) @db.VarChar(21)
  full_name        String             @db.VarChar(150)
  speciality       String             @db.VarChar(50)
  degrees          String?            @db.VarChar(50)
  created_at       DateTime?          @default(now()) @db.Timestamp(0)
  updated_at       DateTime?          @default(now()) @db.Timestamp(0)
  territory_code   String             @db.VarChar(6)
  area_name        String?            @db.VarChar(50)
  dr_master_id     String             @unique(map: "dr_master_id") @db.VarChar(8)
  dr_child_id      String?            @db.VarChar(8)
  chamber          String?            @db.Text
  event_consultant event_consultant[]
}

model event {
  id                    String                      @id @default(nanoid()) @db.VarChar(21)
  title                 String                      @db.VarChar(100)
  event_date            DateTime                    @db.DateTime(0)
  user_id               String                      @db.VarChar(10)
  product_id            String                      @db.VarChar(21)
  venue_name            String                      @db.VarChar(150)
  venue_address         String                      @db.VarChar(150)
  institute             String                      @db.VarChar(150)
  institute_unit        String                      @db.VarChar(50)
  institute_dept        String                      @db.VarChar(25)
  objective             String                      @db.VarChar(150)
  event_type            String                      @db.VarChar(100)
  internal_participants Int
  external_participants Int
  details_participants  String?                     @db.Text
  approved_material     event_approved_material
  material_code         String?                     @db.VarChar(10)
  current_status        event_current_status?
  created_at            DateTime?                   @default(now()) @db.Timestamp(0)
  updated_at            DateTime?                   @default(now()) @db.Timestamp(0)
  other_participants    Int?
  venue_appropriateness event_venue_appropriateness
  track_no              String?                     @db.VarChar(20)
  user                  user                        @relation(fields: [user_id], references: [work_area_code], onDelete: Cascade, map: "event_ibfk_1")
  product               product                     @relation(fields: [product_id], references: [id], onUpdate: Restrict, map: "event_ibfk_2")
  event_approver        event_approver[]
  event_attachment      event_attachment[]
  event_budget          event_budget[]
  event_consultant      event_consultant[]

  @@unique([user_id, product_id], map: "user_id")
  @@index([event_type], map: "event_type_id")
  @@index([product_id], map: "product_id")
}

model event_approver {
  id         String                   @id @default(nanoid()) @db.VarChar(21)
  event_id   String                   @db.VarChar(21)
  user_id    String                   @db.VarChar(21)
  user_role  user_role
  created_at DateTime?                @default(now()) @db.Timestamp(0)
  updated_at DateTime?                @default(now()) @db.Timestamp(0)
  event      event                    @relation(fields: [event_id], references: [id], onDelete: Cascade, map: "event_approver_ibfk_1")
  user       user                     @relation(fields: [user_id], references: [work_area_code], onDelete: Cascade, map: "event_approver_ibfk_2")

  @@unique([event_id, user_id], map: "event_id")
  @@index([user_id], map: "user_id")
}

model event_attachment {
  id             String    @id @default(nanoid()) @db.VarChar(21)
  event_id       String    @db.VarChar(21)
  document_title String    @db.VarChar(100)
  file_path      String    @db.VarChar(200)
  created_at     DateTime? @default(now()) @db.Timestamp(0)
  updated_at     DateTime? @default(now()) @db.Timestamp(0)
  event          event     @relation(fields: [event_id], references: [id], onDelete: Cascade, map: "event_attachment_ibfk_1")

  @@index([event_id], map: "event_id")
}

model event_budget {
  id         String    @id @default(nanoid()) @db.VarChar(21)
  event_id   String    @db.VarChar(21)
  item       String    @db.VarChar(100)
  unit       Int
  unit_cost  Decimal   @db.Decimal(10, 2)
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)
  event      event     @relation(fields: [event_id], references: [id], onDelete: Cascade, map: "event_budget_ibfk_1")

  @@index([event_id], map: "event_id")
}

model event_status_history {
  id                String               @id @default(nanoid()) @db.VarChar(21)
  event_approver_id String               @db.VarChar(21)
  status            event_current_status
  created_at        DateTime?            @default(now()) @db.Timestamp(0)
  updated_at        DateTime?            @default(now()) @db.Timestamp(0)
}

model event_type {
  id          String     @id @default(nanoid()) @db.VarChar(21)
  title       String     @db.VarChar(150)
  lower_limit Decimal?   @default(0.00) @db.Decimal(10, 2)
  upper_limit Decimal?   @default(0.00) @db.Decimal(10, 2)
  created_at  DateTime?  @default(now()) @db.Timestamp(0)
  updated_at  DateTime?  @default(now()) @db.Timestamp(0)
  approver    approver[]
}

model product {
  id         String    @id @default(nanoid()) @db.VarChar(21)
  name       String    @db.VarChar(150)
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)
  event      event[]
}

model user {
  work_area_code String           @unique(map: "employee_id") @db.VarChar(10)
  created_at     DateTime?        @default(now()) @db.Timestamp(0)
  updated_at     DateTime?        @default(now()) @db.Timestamp(0)
  password       String           @db.VarChar(150)
  role           user_role
  id             String           @id @unique(map: "id") @default(nanoid()) @db.VarChar(21)
  event          event[]
  event_approver event_approver[]
  user_details   user_details?
}

model user_details {
  id           String    @id @default(nanoid()) @db.VarChar(21)
  user_id      String    @unique(map: "user_id") @db.VarChar(10)
  full_name    String    @db.VarChar(150)
  department   String    @db.VarChar(50)
  designation  String    @db.VarChar(50)
  region       String    @db.VarChar(50)
  region_id    String    @db.VarChar(10)
  territory_id String    @db.VarChar(10)
  created_at   DateTime? @default(now()) @db.Timestamp(0)
  updated_at   DateTime? @default(now()) @db.Timestamp(0)
  mobile       String    @db.VarChar(14)
  email        String?   @db.VarChar(150)
  user         user      @relation(fields: [user_id], references: [work_area_code], onDelete: Cascade, map: "user_details_ibfk_1")
}

model event_consultant {
  id         String    @id @default(nanoid()) @db.VarChar(21)
  doctor_id  String    @db.VarChar(21)
  event_id   String    @db.VarChar(21)
  duration_h Decimal   @db.Decimal(5, 2)
  role       String    @db.VarChar(100)
  honorarium Decimal?  @default(0.00) @db.Decimal(8, 2)
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)
  doctor     doctor    @relation(fields: [doctor_id], references: [id], map: "event_consultant_ibfk_1")
  event      event     @relation(fields: [event_id], references: [id], onDelete: Cascade, map: "event_consultant_ibfk_2")

  @@unique([doctor_id, event_id], map: "doctor_id")
  @@index([event_id], map: "event_id")
}

model ao {
  employee_id    String @unique(map: "employee_id") @db.VarChar(6)
  full_name      String @db.VarChar(150)
  designation    String @db.VarChar(100)
  email          String @db.VarChar(200)
  group_name     String @db.VarChar(10)
  rm_code        String @db.VarChar(6)
  zm_code        String @db.VarChar(6)
  wing_code      String @db.VarChar(6)
  work_area_code String @id @db.VarChar(6)
}

model director {
  full_name      String @db.VarChar(150)
  designation    String @db.VarChar(100)
  email          String @db.VarChar(200)
  group_name     String @db.VarChar(10)
  work_area_code String @id @db.VarChar(6)
}

model flm {
  full_name      String @db.VarChar(150)
  designation    String @db.VarChar(100)
  email          String @db.VarChar(200)
  group_name     String @db.VarChar(10)
  zm_code        String @db.VarChar(6)
  wing_code      String @db.VarChar(6)
  work_area_code String @id @db.VarChar(6)
}

model slm {
  full_name      String @db.VarChar(150)
  designation    String @db.VarChar(100)
  email          String @db.VarChar(200)
  group_name     String @db.VarChar(10)
  wing_code      String @db.VarChar(6)
  work_area_code String @id @db.VarChar(6)
}

enum approver_type {
  first
  second
  third
  final
  budget
}

enum event_approved_material {
  promotional
  non_branded
}

enum event_current_status {
  approved
  rejected
  rewrite
}

enum event_venue_appropriateness {
  yes
  no
}

enum user_role {
  ao
  flm
  slm
  marketing
  director
  superadmin
  eo
}

